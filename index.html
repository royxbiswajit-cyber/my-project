<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sci-Fi Hologram Planet</title>
<style>
body { margin:0; overflow:hidden; background:black; }
video { position:fixed; right:0; top:0; width:200px; opacity:0.15; pointer-events:none; }
canvas { display:block; }
</style>
</head>
<body>

<video id="cam" autoplay playsinline></video>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/jsm/postprocessing/EffectComposer.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/jsm/postprocessing/RenderPass.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/jsm/postprocessing/UnrealBloomPass.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js"></script>

<script>
/* ---- CAMERA FEED ---- */
const cam = document.getElementById("cam");
navigator.mediaDevices.getUserMedia({video:true}).then(s=>cam.srcObject=s);

/* ---- THREE SCENE ---- */
const scene = new THREE.Scene();
scene.fog = new THREE.FogExp2(0x001133,0.02);

const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 1000);
camera.position.set(0,2,6);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

/* ---- POST FX ---- */
const composer = new THREE.EffectComposer(renderer);
composer.addPass(new THREE.RenderPass(scene, camera));
composer.addPass(new THREE.UnrealBloomPass(new THREE.Vector2(innerWidth,innerHeight),1.4,0.4,0.85));

/* ---- NEON GRID ---- */
const grid = new THREE.GridHelper(40,60,0x00ffff,0x0033aa);
grid.position.y=-1;
scene.add(grid);

/* ---- HOLOGRAM PLANET ---- */
const geo = new THREE.SphereGeometry(1.5,64,64);
const mat = new THREE.MeshStandardMaterial({
color:0x00ccff,
wireframe:true,
emissive:0x00aaff,
emissiveIntensity:1
});
const planet = new THREE.Mesh(geo,mat);
scene.add(planet);

/* ---- LIGHTS ---- */
const light = new THREE.PointLight(0x00aaff,2,50);
light.position.set(0,2,4);
scene.add(light);

/* ---- HAND â†’ CONTROL MAP ---- */
let hx=0, hy=0, hz=0;
function updateHand(cx, cy, z){
hx = (cx-0.5)*2;    // orbit left/right
hy = (cy-0.5)*2;    // tilt up/down
hz = z;             // zoom + scale
}

/* ---- HAND TRACK ---- */
const hands = new Hands({locateFile:f=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${f}`});
hands.setOptions({maxNumHands:1,modelComplexity:1});
hands.onResults(res=>{
if(!res.multiHandLandmarks) return;
const p=res.multiHandLandmarks[0][9]; // center-ish
updateHand(p.x, p.y, p.z);
});
const camFeed = new Camera(cam,{onFrame:async()=>{await hands.send({image:cam});}}); camFeed.start();

/* ---- FACE HOLOGRAM ---- */
const face = new FaceMesh({locateFile:f=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${f}`});
face.setOptions({maxNumFaces:1});
face.onResults(r=>{ /* can extend projection here */ });
const cam2 = new Camera(cam,{onFrame:async()=>{await face.send({image:cam});}}); cam2.start();

/* ---- LOOP ---- */
function animate(){
requestAnimationFrame(animate);

planet.rotation.y += 0.005 + hx*0.02;
planet.rotation.x += hy*0.01;
planet.scale.setScalar(1 + (0.5-hz)*1.2);

camera.position.x = Math.sin(hx)*6;
camera.position.z = Math.cos(hx)*6;
camera.position.y = 2 + hy*2;
camera.lookAt(0,0,0);

composer.render();
}
animate();

onresize=()=>{renderer.setSize(innerWidth,innerHeight);camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();}
</script>
</body>
</html>
